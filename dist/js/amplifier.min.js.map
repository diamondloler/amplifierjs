{"version":3,"sources":["amplifier.js"],"names":["root","factory","define","amd","exports","module","amplifier","global","window","this","selector","imgClassName","mask","center_el","scale_el","body","document","options","transitionDuration","transitionTimingFunction","bgColor","scale","onOpen","onClose","onBeforeClose","onBeforeOpen","display","UA","navigator","userAgent","toLowerCase","isIE","test","setStyle","target","styles","style","close","domBody","centerElement","scaleElement","maskElement","setTimeout","timeString","els","styleList","cursor","transform","opacity","zIndex","len","length","wrapper","pureEL","removeChild","children","parentNode","replaceChild","indexOf","replace","Number","handlerClick","e","distance","mask_el","target_","stopPropagation","className","cssText","createElement","cloneNode","appendChild","position","transition","backgroundColor","top","bottom","left","right","elem","undefined","nodeType","TypeError","domRect","getBoundingClientRect","centerDistance","x","y","clientWidth","width","clientHeight","height","getTranslation","publicApis","init","options_","clickImgs","querySelectorAll","clickAgent","querySelector","i","arguments","source","key","hasOwnProperty","merge","addEventListener","destory","removeEventListener"],"mappings":"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","file":"amplifier.min.js","sourcesContent":["(function (root, factory) {\r\n  if (typeof define === 'function' && define.amd) {\r\n    define([], function () {\r\n      return factory(root);\r\n    });\r\n  } else if (typeof exports === \"object\" && typeof module !== \"undefined\") {\r\n    module.exports = factory(root);\r\n  } else {\r\n    root.amplifier = factory(root);\r\n  }\r\n})(typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : this, function (window) {\r\n  var amplifier = function (selector, imgClassName) {\r\n   \r\n    var body = document.body, // dom body\r\n      mask, // the HTMLelement to mask page\r\n      center_el, // the HTMLelement to align center (horizatal, vertical) on mask\r\n      scale_el // the HTMLelement to scale on center_el\r\n\r\n\r\n    //default settings for init\r\n    var options = {\r\n      transitionDuration: '.35s',\r\n      transitionTimingFunction: 'cubic-bezier(.4,0,0,1)',\r\n      bgColor: 'rgba(255, 255, 255, .8)',\r\n      scale: 2,\r\n      onOpen: null,\r\n      onClose: null,\r\n      onBeforeClose: null,\r\n      onBeforeOpen: null,\r\n      display: 'block'\r\n    }\r\n\r\n    // IE compatibility\r\n    var inBrowser = typeof window !== 'undefined'\r\n    var UA = inBrowser && window.navigator.userAgent.toLowerCase();\r\n    var isIE = UA && /msie|trident/.test(UA);\r\n\r\n    /**\r\n     * merge object\r\n     * @param {Object} target the 1st argument is object by merged, extra arguments is the sources to merge\r\n     * @return {Object} return merged object\r\n     */\r\n    var merge = function (target) {\r\n      for (var i = 1; i < arguments.length; i++) {\r\n          var source = arguments[i] || {};\r\n          for (var key in source) {\r\n              if (source.hasOwnProperty(key) && source[key] !== undefined) {\r\n                  target[key] = source[key]\r\n              }\r\n          }\r\n      }\r\n      return target;\r\n    }\r\n\r\n\r\n    /**\r\n     * get the translation of HTMLElment to center\r\n     * @param {HTMLElment} elem\r\n     * @return {Object}\r\n     */\r\n    var getTranslation = function (elem) {\r\n      if (elem == undefined || typeof elem.nodeType == 'undefined' || elem.nodeType != 1) {\r\n        throw new TypeError(\"The 1st parameter must be a HTMLElement\");\r\n      }\r\n\r\n      var domRect = elem.getBoundingClientRect(),\r\n        centerDistance = {\r\n          x: 0,\r\n          y: 0\r\n        };\r\n\r\n\r\n      centerDistance.x = body.clientWidth / 2 - domRect.left - domRect.width / 2;\r\n      centerDistance.y = body.clientHeight / 2 - domRect.top - domRect.height / 2;\r\n\r\n      return centerDistance;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * add parentNode for target\r\n     * @param {HTMLElment} target HTMLElment\r\n     * @return {HTMLElment} a HTMLElment with wrapper\r\n     */\r\n    var appendImgWrapper = function (target) {\r\n      var wrapper = document.createElement('div')\r\n      var target_ = target.cloneNode(true)\r\n      wrapper.appendChild(target_)\r\n      target.parentNode.replaceChild(wrapper, target)\r\n      return wrapper\r\n    }\r\n\r\n\r\n    /**\r\n     * remove parentNode\r\n     * @param {HTMLElment} wrapper HTMLElment\r\n     * @return {HTMLElment} a HTMLElment without wrapper\r\n     */\r\n    var removeImgWrapper = function (wrapper) {\r\n      var pureEL = wrapper.children[0]\r\n      wrapper.parentNode.replaceChild(pureEL, wrapper)\r\n      return pureEL\r\n    }\r\n\r\n\r\n    /**\r\n     * set style for target\r\n     * @param {HTMLElment} target HTMLElment\r\n     * @param {Object} styles  an object with some styles\r\n     * @return {HTMLElment} return HTMLElment with some styles\r\n     */\r\n    var setStyle = function (target, styles) {\r\n      for (var style in styles) {\r\n        target.style[style] = styles[style]\r\n      }\r\n\r\n      return target\r\n    }\r\n\r\n    /**\r\n     * transfer time string to number\r\n     * @param {HTMLElment} timeString a string with time, like 0.34s\r\n     * @return {Number} return number\r\n     */\r\n    var timePatch = function (timeString) { \r\n      if (timeString.indexOf('.') == 0)  timeString = '0' + timeString.replace('s', '')\r\n      return Number(timeString) * 1000\r\n    }\r\n\r\n    /**\r\n     * close -> restore \r\n     * @param {HTMLElment} domBody document body\r\n     * @param {HTMLElment} centerElement  the centerElement need to restore\r\n     * @param {HTMLElment} scaleElement the scaleElement need to restore\r\n     * @param {HTMLElment} maskElement the maskElement need to restore\r\n     */\r\n    var close = function (domBody, centerElement, scaleElement, maskElement) {\r\n      if (typeof options.onBeforeClose === 'function') {\r\n            options.onBeforeClose()\r\n      }\r\n      //async end animation\r\n      setTimeout(function () {\r\n        var els = [scaleElement, centerElement, maskElement]\r\n        var styleList = [\r\n          {\r\n            cursor: isIE ? 'pointer' : 'zoom-in',\r\n            transform: ''\r\n          },\r\n          {\r\n            transform: ''\r\n          },\r\n          {\r\n            opacity: '0',\r\n            zIndex: ''\r\n          }\r\n        ]\r\n\r\n        var len = els.length\r\n\r\n        while (len--)\r\n          setStyle(els[len], styleList[len])\r\n\r\n        setTimeout(function () {\r\n          domBody.removeChild(maskElement)\r\n          removeImgWrapper(centerElement)\r\n          if (typeof options.onClose === 'function') {\r\n            options.onClose(scaleElement)\r\n          }\r\n        }, timePatch(options.transitionDuration))\r\n\r\n      }, 10)\r\n    }\r\n\r\n\r\n    /**\r\n     * create a mask HTMLElment\r\n     * @return {HTMLElement}\r\n     */\r\n    var createMask = function () {\r\n      var mask_el = null\r\n      mask_el = document.createElement('div')\r\n      return setStyle(mask_el, {\r\n        backgroundColor: options.bgColor,\r\n        position: 'fixed',\r\n        opacity: '0',\r\n        top: '0',\r\n        bottom: '0',\r\n        left: '0',\r\n        right: '0',\r\n        transition: 'opacity' + ' ' + options.transitionDuration + ' ' + options.transitionTimingFunction\r\n\r\n      })\r\n    }\r\n\r\n\r\n    /**\r\n     * open -> start the animation\r\n     * @param {Object} distance  an object width x-distance, y-distance\r\n     * @param {HTMLElment} centerElement  the centerElement need to center\r\n     * @param {HTMLElment} scaleElement the scaleElement need to scale\r\n     * @param {HTMLElment} maskElement the maskElement need to mask\r\n     */\r\n    var open = function (maskElement, centerElement, scaleElement, distance) {\r\n       if (typeof options.onBeforeOpen === 'function') {\r\n          options.onBeforeOpen()\r\n       }\r\n       //async start animation\r\n       setTimeout(function () {\r\n          var els = [scaleElement, centerElement, maskElement]\r\n          var styleList = [\r\n            {\r\n              cursor: isIE ? 'pointer' : 'zoom-out',\r\n              transform: 'scale('+ options.scale + ')'\r\n            },\r\n            {\r\n              zIndex: '9999',\r\n              transform: 'translate(' + distance.x + 'px,' + distance.y + 'px)'\r\n            },\r\n            {\r\n              opacity: '',\r\n              zIndex: '1000'\r\n            }\r\n          ]\r\n\r\n          var len = els.length\r\n\r\n          while (len--)\r\n            setStyle(els[len], styleList[len])\r\n\r\n          if (typeof options.onOpen === 'function') {\r\n              options.onOpen(scaleElement)\r\n          }\r\n\r\n      }, 6)\r\n\r\n    }\r\n\r\n   \r\n    // a click handler for image by binded\r\n    var handlerClick = function (e) {\r\n      var target = e.target;\r\n\r\n      e.stopPropagation();\r\n\r\n      //bind the target by imgClassName\r\n      if (target.className.indexOf(imgClassName) > -1) {\r\n        //confirm scale status and then close\r\n        if (target.style.cssText.indexOf('transform: scale(' + options.scale + ')') > -1) {\r\n          close(body, center_el, scale_el, mask)\r\n          return;\r\n        }\r\n\r\n        //get the center HTMLElment by event target and set the styles\r\n        center_el = \r\n        setStyle(appendImgWrapper(target), {display: options.display, position: 'relative', transition: 'all' + ' ' + options.transitionDuration + ' ' + options.transitionTimingFunction})\r\n        //get the scale HTMLElment by event center_el and set the styles\r\n        scale_el = \r\n        setStyle(center_el.children[0], { transition: 'all' +  ' ' + options.transitionDuration + ' ' + options.transitionTimingFunction })\r\n        //create a mask HTMLElment\r\n        mask = createMask()\r\n\r\n        body.appendChild(mask)\r\n\r\n        open(mask, center_el, scale_el, getTranslation(center_el))\r\n    \r\n      }\r\n    }\r\n\r\n    //public apis\r\n    var publicApis = {}\r\n\r\n    publicApis.init = function (options_) {\r\n      var clickImgs = document.querySelectorAll('.' + imgClassName)\r\n      var clickAgent = document.querySelector(selector)\r\n\r\n      //mrege options\r\n      options = merge(options, options_)\r\n\r\n      // init img's cursor\r\n      for (var i = 0; i < clickImgs.length; i++) {\r\n          setStyle(clickImgs[i], {cursor: isIE ? 'pointer' : 'zoom-in'})\r\n      }\r\n\r\n      //add then event listenr\r\n      clickAgent.addEventListener('click', handlerClick, false)\r\n    }\r\n\r\n    publicApis.destory = function () {\r\n      //reset defult\r\n      mask = null\r\n      center_el = null\r\n      scale_el = null\r\n      //remove then event listenr\r\n      clickAgent.removeEventListener('click', handlerClick);\r\n    }\r\n\r\n    //return apis\r\n    return publicApis\r\n  }\r\n  return amplifier;\r\n})\r\n"]}